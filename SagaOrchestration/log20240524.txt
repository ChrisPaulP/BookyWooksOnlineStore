2024-05-24 13:01:23.068 +01:00 [WRN] No store type was specified for the decimal property 'OrderTotal' on entity type 'OrderStateInstance'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2024-05-24 13:01:24.197 +01:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-24 13:01:24.245 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-24 13:01:24.266 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-24 13:01:24.276 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-24 13:01:24.315 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-05-24 13:01:24.342 +01:00 [INF] No migrations were applied. The database is already up to date.
2024-05-24 13:01:25.728 +01:00 [INF] Configured endpoint create-order-message-queue, Saga: SagaOrchestration.StateInstances.OrderStateInstance, State Machine: SagaOrchestration.StateMachines.OrderStateMachine
2024-05-24 13:01:26.064 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-24 13:01:26.105 +01:00 [INF] Hosting environment: Development
2024-05-24 13:01:26.141 +01:00 [INF] Content root path: C:\Users\porterc\source\repos\BookyWooksOnlineStore\SagaOrchestration
2024-05-24 13:01:26.800 +01:00 [INF] Bus started: "rabbitmq://localhost/"
2024-05-24 13:01:38.670 +01:00 [INF] Executed DbCommand (205ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:01:48.865 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:01:58.869 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:02:09.923 +01:00 [INF] Executed DbCommand (29ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:02:23.628 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:02:27.795 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:02:28.105 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:02:28.124 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int64), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [InboxState] ([Consumed], [ConsumerId], [Delivered], [ExpirationTime], [LastSequenceNumber], [LockId], [MessageId], [ReceiveCount], [Received])
OUTPUT INSERTED.[Id], INSERTED.[RowVersion]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2024-05-24 13:02:28.301 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:02:28.344 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:02:28.361 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:02:28.460 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CorrelationId], [o].[CreatedDate], [o].[CurrentState], [o].[CustomerId], [o].[OrderId], [o].[OrderTotal]
FROM [OrderStateInstance] AS [o]
WHERE [o].[OrderId] = '78fbf157-042e-479c-a189-a4fba12bbe70'
2024-05-24 13:02:28.540 +01:00 [INF] CreateOrderMessage received in OrderStateMachine: CorrelationId: c5dc0e61-9818-4db3-acfa-ebe92edcfca1
CurrentState: Initial
OrderId: 00000000-0000-0000-0000-000000000000
CustomerId: 00000000-0000-0000-0000-000000000000
OrderTotal: 0
CreatedDate: 01/01/0001 00:00:00
------------------------ 
2024-05-24 13:02:28.799 +01:00 [INF] CheckBookStockCommand published in OrderStateMachine: CorrelationId: c5dc0e61-9818-4db3-acfa-ebe92edcfca1
CurrentState: StockCheck
OrderId: 78fbf157-042e-479c-a189-a4fba12bbe70
CustomerId: 4287c1cf-40be-44d1-8639-5781514f3f8a
OrderTotal: 42.48
CreatedDate: 24/05/2024 12:02:28
------------------------ 
2024-05-24 13:02:28.862 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p4='?' (DbType = Guid), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [OrderStateInstance] ([CorrelationId], [CreatedDate], [CurrentState], [CustomerId], [OrderId], [OrderTotal])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-05-24 13:02:28.923 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:02:28.947 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary), @p9='?' (Size = 4000), @p10='?' (Size = 256), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (Size = 256), @p14='?' (DbType = DateTime2), @p15='?' (DbType = DateTime2), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Guid), @p22='?' (Size = 4000), @p23='?' (DbType = Guid), @p24='?' (Size = 4000), @p25='?' (DbType = Guid), @p26='?' (Size = 256), @p27='?' (DbType = DateTime2), @p28='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
INSERT INTO [OutboxMessage] ([Body], [ContentType], [ConversationId], [CorrelationId], [DestinationAddress], [EnqueueTime], [ExpirationTime], [FaultAddress], [Headers], [InboxConsumerId], [InboxMessageId], [InitiatorId], [MessageId], [MessageType], [OutboxId], [Properties], [RequestId], [ResponseAddress], [SentTime], [SourceAddress])
OUTPUT INSERTED.[SequenceNumber]
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28);
2024-05-24 13:02:28.986 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:02:28.998 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:02:29.008 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:02:29.052 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_3='?' (DbType = Int32), @__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid), @__lastSequenceNumber_2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_3) [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1 AND [o].[SequenceNumber] > @__lastSequenceNumber_2
ORDER BY [o].[SequenceNumber]
2024-05-24 13:02:29.216 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:02:29.224 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:02:29.242 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:02:29.267 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:02:29.275 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:02:29.291 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_3='?' (DbType = Int32), @__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid), @__lastSequenceNumber_2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_3) [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1 AND [o].[SequenceNumber] > @__lastSequenceNumber_2
ORDER BY [o].[SequenceNumber]
2024-05-24 13:02:29.319 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:02:29.328 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:02:29.348 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:02:29.360 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:02:29.388 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:02:36.080 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1
2024-05-24 13:02:36.053 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:02:36.169 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:02:36.183 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [OutboxMessage]
OUTPUT 1
WHERE [SequenceNumber] = @p0;
2024-05-24 13:02:43.973 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:02:43.984 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:02:43.998 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int64), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [InboxState] ([Consumed], [ConsumerId], [Delivered], [ExpirationTime], [LastSequenceNumber], [LockId], [MessageId], [ReceiveCount], [Received])
OUTPUT INSERTED.[Id], INSERTED.[RowVersion]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2024-05-24 13:02:44.698 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:29:50.495 +01:00 [WRN] No store type was specified for the decimal property 'OrderTotal' on entity type 'OrderStateInstance'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2024-05-24 13:29:54.535 +01:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-24 13:29:54.604 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-24 13:29:54.637 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-24 13:29:54.664 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-24 13:29:54.742 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-05-24 13:29:54.835 +01:00 [INF] No migrations were applied. The database is already up to date.
2024-05-24 13:29:58.672 +01:00 [INF] Configured endpoint create-order-message-queue, Saga: SagaOrchestration.StateInstances.OrderStateInstance, State Machine: SagaOrchestration.StateMachines.OrderStateMachine
2024-05-24 13:29:58.892 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-24 13:29:58.904 +01:00 [INF] Hosting environment: Development
2024-05-24 13:29:58.922 +01:00 [INF] Content root path: C:\Users\porterc\source\repos\BookyWooksOnlineStore\SagaOrchestration
2024-05-24 13:30:00.342 +01:00 [INF] Bus started: "rabbitmq://localhost/"
2024-05-24 13:30:01.616 +01:00 [INF] Executed DbCommand (113ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:30:02.012 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:30:02.101 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:30:12.856 +01:00 [INF] Executed DbCommand (55ms) [Parameters=[@__id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [o].[CorrelationId], [o].[CreatedDate], [o].[CurrentState], [o].[CustomerId], [o].[OrderId], [o].[OrderTotal]
FROM [OrderStateInstance] AS [o]
WHERE [o].[CorrelationId] = @__id
2024-05-24 13:30:13.027 +01:00 [INF] Executed DbCommand (61ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:30:13.199 +01:00 [INF] StockReservationFailedEvent received in OrderStateMachine: CorrelationId: c5dc0e61-9818-4db3-acfa-ebe92edcfca1
CurrentState: StockCheck
OrderId: 78fbf157-042e-479c-a189-a4fba12bbe70
CustomerId: 4287c1cf-40be-44d1-8639-5781514f3f8a
OrderTotal: 42.48
CreatedDate: 24/05/2024 12:02:28
------------------------ 
2024-05-24 13:30:15.813 +01:00 [INF] Executed DbCommand (135ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [InboxState]
OUTPUT 1
WHERE [Id] = @p0 AND [RowVersion] = @p1;
2024-05-24 13:30:16.187 +01:00 [INF] Executed DbCommand (38ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:30:16.842 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:30:16.913 +01:00 [INF] Executed DbCommand (107ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [OrderStateInstance] SET [CurrentState] = @p0
OUTPUT 1
WHERE [CorrelationId] = @p1;
2024-05-24 13:30:17.163 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:30:17.255 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int64), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [InboxState] ([Consumed], [ConsumerId], [Delivered], [ExpirationTime], [LastSequenceNumber], [LockId], [MessageId], [ReceiveCount], [Received])
OUTPUT INSERTED.[Id], INSERTED.[RowVersion]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2024-05-24 13:30:17.343 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:30:17.380 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:30:17.387 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary), @p9='?' (Size = 4000), @p10='?' (Size = 256), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (Size = 256), @p14='?' (DbType = DateTime2), @p15='?' (DbType = DateTime2), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Guid), @p22='?' (Size = 4000), @p23='?' (DbType = Guid), @p24='?' (Size = 4000), @p25='?' (DbType = Guid), @p26='?' (Size = 256), @p27='?' (DbType = DateTime2), @p28='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
INSERT INTO [OutboxMessage] ([Body], [ContentType], [ConversationId], [CorrelationId], [DestinationAddress], [EnqueueTime], [ExpirationTime], [FaultAddress], [Headers], [InboxConsumerId], [InboxMessageId], [InitiatorId], [MessageId], [MessageType], [OutboxId], [Properties], [RequestId], [ResponseAddress], [SentTime], [SourceAddress])
OUTPUT INSERTED.[SequenceNumber]
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28);
2024-05-24 13:30:17.421 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:30:17.447 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:30:17.449 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:30:17.490 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:30:17.489 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [o].[CorrelationId], [o].[CreatedDate], [o].[CurrentState], [o].[CustomerId], [o].[OrderId], [o].[OrderTotal]
FROM [OrderStateInstance] AS [o]
WHERE [o].[CorrelationId] = @__id
2024-05-24 13:30:17.519 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:30:17.592 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_3='?' (DbType = Int32), @__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid), @__lastSequenceNumber_2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_3) [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1 AND [o].[SequenceNumber] > @__lastSequenceNumber_2
ORDER BY [o].[SequenceNumber]
2024-05-24 13:30:17.789 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:30:17.806 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:30:17.828 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:30:17.844 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:30:17.889 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:30:17.870 +01:00 [ERR] R-FAULT "rabbitmq://localhost/create-order-message-queue" "209e0000-6098-c423-33c1-08dc7bed43ff" BookyWooks.Messaging.Contracts.Events.StockReservationFailedEvent SagaOrchestration.StateInstances.OrderStateInstance("00:00:00.0613381")
MassTransit.NotAcceptedStateMachineException: SagaOrchestration.StateInstances.OrderStateInstance(c5dc0e61-9818-4db3-acfa-ebe92edcfca1) Saga exception on receipt of BookyWooks.Messaging.Contracts.Events.StockReservationFailedEvent: Not accepted in state Final
 ---> MassTransit.UnhandledEventException: The StockReservationFailedEvent event is not handled during the Final state for the OrderStateMachine state machine
   at MassTransit.MassTransitStateMachine`1.DefaultUnhandledEventCallback(UnhandledEventContext`1 context) in /_/src/MassTransit/SagaStateMachine/MassTransitStateMachine.cs:line 222
   at MassTransit.MassTransitStateMachine`1.UnhandledEvent(BehaviorContext`1 context, State state) in /_/src/MassTransit/SagaStateMachine/MassTransitStateMachine.cs:line 1266
   at MassTransit.MassTransitStateMachine`1.<.ctor>b__19_2(BehaviorContext`1 context, State state) in /_/src/MassTransit/SagaStateMachine/MassTransitStateMachine.cs:line 55
   at MassTransit.MassTransitStateMachine`1.StateMachineState.MassTransit.State<TInstance>.Raise[T](BehaviorContext`2 context) in /_/src/MassTransit/SagaStateMachine/SagaStateMachine/StateMachineState.cs:line 165
   at MassTransit.MassTransitStateMachine`1.MassTransit.StateMachine<TInstance>.RaiseEvent[T](BehaviorContext`2 context) in /_/src/MassTransit/SagaStateMachine/MassTransitStateMachine.cs:line 135
   at MassTransit.Middleware.StateMachineSagaMessageFilter`2.Send(SagaConsumeContext`2 context, IPipe`1 next) in /_/src/MassTransit/Middleware/StateMachineSagaMessageFilter.cs:line 66
   --- End of inner exception stack trace ---
   at MassTransit.Middleware.StateMachineSagaMessageFilter`2.Send(SagaConsumeContext`2 context, IPipe`1 next) in /_/src/MassTransit/Middleware/StateMachineSagaMessageFilter.cs:line 81
   at MassTransit.Middleware.StateMachineSagaMessageFilter`2.Send(SagaConsumeContext`2 context, IPipe`1 next) in /_/src/MassTransit/Middleware/StateMachineSagaMessageFilter.cs:line 104
   at MassTransit.Middleware.SendSagaPipe`2.Send(SagaRepositoryContext`2 context) in /_/src/MassTransit/Middleware/SendSagaPipe.cs:line 43
   at MassTransit.Middleware.SendSagaPipe`2.Send(SagaRepositoryContext`2 context) in /_/src/MassTransit/Middleware/SendSagaPipe.cs:line 67
   at MassTransit.EntityFrameworkCoreIntegration.Saga.EntityFrameworkSagaRepositoryContextFactory`1.<>c__DisplayClass7_0`1.<<Send>g__SendAsyncCallback|0>d.MoveNext() in /_/src/Persistence/MassTransit.EntityFrameworkCoreIntegration/EntityFrameworkCoreIntegration/Saga/EntityFrameworkSagaRepositoryContextFactory.cs:line 67
--- End of stack trace from previous location ---
   at MassTransit.EntityFrameworkCoreIntegration.Saga.EntityFrameworkSagaRepositoryContextFactory`1.Send[T](ConsumeContext`1 context, IPipe`1 next) in /_/src/Persistence/MassTransit.EntityFrameworkCoreIntegration/EntityFrameworkCoreIntegration/Saga/EntityFrameworkSagaRepositoryContextFactory.cs:line 71
   at MassTransit.EntityFrameworkCoreIntegration.Saga.EntityFrameworkSagaRepositoryContextFactory`1.Send[T](ConsumeContext`1 context, IPipe`1 next) in /_/src/Persistence/MassTransit.EntityFrameworkCoreIntegration/EntityFrameworkCoreIntegration/Saga/EntityFrameworkSagaRepositoryContextFactory.cs:line 86
   at MassTransit.DependencyInjection.DependencyInjectionSagaRepositoryContextFactory`1.Send[T](ConsumeContext`1 context, Func`3 send) in /_/src/MassTransit/DependencyInjection/DependencyInjection/DependencyInjectionSagaRepositoryContextFactory.cs:line 59
   at MassTransit.Middleware.CorrelatedSagaFilter`2.Send(ConsumeContext`1 context, IPipe`1 next) in /_/src/MassTransit/Middleware/CorrelatedSagaFilter.cs:line 45
2024-05-24 13:30:17.988 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_3='?' (DbType = Int32), @__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid), @__lastSequenceNumber_2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_3) [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1 AND [o].[SequenceNumber] > @__lastSequenceNumber_2
ORDER BY [o].[SequenceNumber]
2024-05-24 13:30:18.059 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:30:18.079 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:30:18.143 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:30:18.170 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:30:18.186 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:30:18.233 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1
2024-05-24 13:30:18.253 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:30:18.267 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [OutboxMessage]
OUTPUT 1
WHERE [SequenceNumber] = @p0;
2024-05-24 13:30:29.900 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:30:39.941 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:30:49.974 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:30:49.994 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [InboxState]
OUTPUT 1
WHERE [Id] = @p0 AND [RowVersion] = @p1;
2024-05-24 13:30:50.010 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:31:00.035 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:31:13.446 +01:00 [INF] Executed DbCommand (27ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:31:37.505 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:32:50.854 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:32:51.726 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:32:51.742 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:32:51.752 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int64), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [InboxState] ([Consumed], [ConsumerId], [Delivered], [ExpirationTime], [LastSequenceNumber], [LockId], [MessageId], [ReceiveCount], [Received])
OUTPUT INSERTED.[Id], INSERTED.[RowVersion]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2024-05-24 13:32:51.793 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:32:51.838 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:32:51.852 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:32:51.904 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CorrelationId], [o].[CreatedDate], [o].[CurrentState], [o].[CustomerId], [o].[OrderId], [o].[OrderTotal]
FROM [OrderStateInstance] AS [o]
WHERE [o].[OrderId] = 'a01d7344-77f3-493f-9c6d-8847fa8862eb'
2024-05-24 13:32:51.933 +01:00 [INF] CreateOrderMessage received in OrderStateMachine: CorrelationId: 06783575-9f1a-4f1b-b640-16cd4a89bef0
CurrentState: Initial
OrderId: 00000000-0000-0000-0000-000000000000
CustomerId: 00000000-0000-0000-0000-000000000000
OrderTotal: 0
CreatedDate: 01/01/0001 00:00:00
------------------------ 
2024-05-24 13:32:51.969 +01:00 [INF] CheckBookStockCommand published in OrderStateMachine: CorrelationId: 06783575-9f1a-4f1b-b640-16cd4a89bef0
CurrentState: StockCheck
OrderId: a01d7344-77f3-493f-9c6d-8847fa8862eb
CustomerId: 4287c1cf-40be-44d1-8639-5781514f3f8a
OrderTotal: 42.48
CreatedDate: 24/05/2024 12:32:51
------------------------ 
2024-05-24 13:32:51.992 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = Guid), @p4='?' (DbType = Guid), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [OrderStateInstance] ([CorrelationId], [CreatedDate], [CurrentState], [CustomerId], [OrderId], [OrderTotal])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-05-24 13:32:52.016 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:32:52.030 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary), @p9='?' (Size = 4000), @p10='?' (Size = 256), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (Size = 256), @p14='?' (DbType = DateTime2), @p15='?' (DbType = DateTime2), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Guid), @p22='?' (Size = 4000), @p23='?' (DbType = Guid), @p24='?' (Size = 4000), @p25='?' (DbType = Guid), @p26='?' (Size = 256), @p27='?' (DbType = DateTime2), @p28='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
INSERT INTO [OutboxMessage] ([Body], [ContentType], [ConversationId], [CorrelationId], [DestinationAddress], [EnqueueTime], [ExpirationTime], [FaultAddress], [Headers], [InboxConsumerId], [InboxMessageId], [InitiatorId], [MessageId], [MessageType], [OutboxId], [Properties], [RequestId], [ResponseAddress], [SentTime], [SourceAddress])
OUTPUT INSERTED.[SequenceNumber]
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28);
2024-05-24 13:32:52.049 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:32:52.064 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:32:52.084 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:32:52.104 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_3='?' (DbType = Int32), @__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid), @__lastSequenceNumber_2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_3) [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1 AND [o].[SequenceNumber] > @__lastSequenceNumber_2
ORDER BY [o].[SequenceNumber]
2024-05-24 13:32:52.172 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:32:52.182 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:33:27.719 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:33:27.721 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:33:30.162 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:30.189 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:33:30.193 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:33:30.218 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:30.220 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_3='?' (DbType = Int32), @__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid), @__lastSequenceNumber_2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_3) [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1 AND [o].[SequenceNumber] > @__lastSequenceNumber_2
ORDER BY [o].[SequenceNumber]
2024-05-24 13:33:30.235 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime2), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int64), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (DbType = Int32), @p8='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [InboxState] ([Consumed], [ConsumerId], [Delivered], [ExpirationTime], [LastSequenceNumber], [LockId], [MessageId], [ReceiveCount], [Received])
OUTPUT INSERTED.[Id], INSERTED.[RowVersion]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2024-05-24 13:33:30.240 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:30.253 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:33:30.253 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:33:30.271 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:30.278 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:33:30.281 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:33:30.300 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:30.309 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [o].[CorrelationId], [o].[CreatedDate], [o].[CurrentState], [o].[CustomerId], [o].[OrderId], [o].[OrderTotal]
FROM [OrderStateInstance] AS [o]
WHERE [o].[CorrelationId] = @__id
2024-05-24 13:33:30.312 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:33:30.327 +01:00 [INF] StockReservationFailedEvent received in OrderStateMachine: CorrelationId: 06783575-9f1a-4f1b-b640-16cd4a89bef0
CurrentState: StockCheck
OrderId: a01d7344-77f3-493f-9c6d-8847fa8862eb
CustomerId: 4287c1cf-40be-44d1-8639-5781514f3f8a
OrderTotal: 42.48
CreatedDate: 24/05/2024 12:32:51
------------------------ 
2024-05-24 13:33:30.336 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1
2024-05-24 13:33:30.343 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [OrderStateInstance] SET [CurrentState] = @p0
OUTPUT 1
WHERE [CorrelationId] = @p1;
2024-05-24 13:33:30.351 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:30.367 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:30.372 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [OutboxMessage]
OUTPUT 1
WHERE [SequenceNumber] = @p0;
2024-05-24 13:33:30.382 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary), @p9='?' (Size = 4000), @p10='?' (Size = 256), @p11='?' (DbType = Guid), @p12='?' (DbType = Guid), @p13='?' (Size = 256), @p14='?' (DbType = DateTime2), @p15='?' (DbType = DateTime2), @p16='?' (Size = 256), @p17='?' (Size = 4000), @p18='?' (DbType = Guid), @p19='?' (DbType = Guid), @p20='?' (DbType = Guid), @p21='?' (DbType = Guid), @p22='?' (Size = 4000), @p23='?' (DbType = Guid), @p24='?' (Size = 4000), @p25='?' (DbType = Guid), @p26='?' (Size = 256), @p27='?' (DbType = DateTime2), @p28='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
INSERT INTO [OutboxMessage] ([Body], [ContentType], [ConversationId], [CorrelationId], [DestinationAddress], [EnqueueTime], [ExpirationTime], [FaultAddress], [Headers], [InboxConsumerId], [InboxMessageId], [InitiatorId], [MessageId], [MessageType], [OutboxId], [Properties], [RequestId], [ResponseAddress], [SentTime], [SourceAddress])
OUTPUT INSERTED.[SequenceNumber]
VALUES (@p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28);
2024-05-24 13:33:30.406 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:33:30.421 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:30.437 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:33:30.451 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_3='?' (DbType = Int32), @__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid), @__lastSequenceNumber_2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_3) [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1 AND [o].[SequenceNumber] > @__lastSequenceNumber_2
ORDER BY [o].[SequenceNumber]
2024-05-24 13:33:30.531 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:32.261 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:33:32.285 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:33:32.300 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:32.315 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:33:32.335 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_3='?' (DbType = Int32), @__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid), @__lastSequenceNumber_2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_3) [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1 AND [o].[SequenceNumber] > @__lastSequenceNumber_2
ORDER BY [o].[SequenceNumber]
2024-05-24 13:33:32.367 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:32.387 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:33:32.411 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[p0='?' (DbType = Guid), p1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [m].[Id], [m].[Consumed], [m].[ConsumerId], [m].[Delivered], [m].[ExpirationTime], [m].[LastSequenceNumber], [m].[LockId], [m].[MessageId], [m].[ReceiveCount], [m].[Received], [m].[RowVersion]
FROM (
    SELECT * FROM InboxState WITH (UPDLOCK, ROWLOCK) WHERE MessageId = @p0 AND ConsumerId = @p1
) AS [m]
2024-05-24 13:33:32.430 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:32.448 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p7='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Int32), @p6='?' (DbType = DateTime2), @p8='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [InboxState] SET [Consumed] = @p0, [Delivered] = @p1, [ExpirationTime] = @p2, [LastSequenceNumber] = @p3, [LockId] = @p4, [ReceiveCount] = @p5, [Received] = @p6
OUTPUT INSERTED.[RowVersion]
WHERE [Id] = @p7 AND [RowVersion] = @p8;
2024-05-24 13:33:32.469 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__MessageId_0='?' (DbType = Guid), @__ConsumerId_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[SequenceNumber], [o].[Body], [o].[ContentType], [o].[ConversationId], [o].[CorrelationId], [o].[DestinationAddress], [o].[EnqueueTime], [o].[ExpirationTime], [o].[FaultAddress], [o].[Headers], [o].[InboxConsumerId], [o].[InboxMessageId], [o].[InitiatorId], [o].[MessageId], [o].[MessageType], [o].[OutboxId], [o].[Properties], [o].[RequestId], [o].[ResponseAddress], [o].[SentTime], [o].[SourceAddress]
FROM [OutboxMessage] AS [o]
WHERE [o].[InboxMessageId] = @__MessageId_0 AND [o].[InboxConsumerId] = @__ConsumerId_1
2024-05-24 13:33:32.490 +01:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2024-05-24 13:33:32.513 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [OutboxMessage]
OUTPUT 1
WHERE [SequenceNumber] = @p0;
2024-05-24 13:33:40.264 +01:00 [INF] Executed DbCommand (57ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:33:50.424 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:34:00.443 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:34:00.464 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [InboxState]
OUTPUT 1
WHERE [Id] = @p0 AND [RowVersion] = @p1;
2024-05-24 13:34:00.483 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:34:10.504 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:34:10.519 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (Size = 8) (DbType = Binary)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [InboxState]
OUTPUT 1
WHERE [Id] = @p0 AND [RowVersion] = @p1;
2024-05-24 13:34:10.530 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 13:34:20.547 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:16:52.217 +00:00 [WRN] No store type was specified for the decimal property 'OrderTotal' on entity type 'OrderStateInstance'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2024-05-24 17:16:52.979 +00:00 [WRN] No store type was specified for the decimal property 'OrderTotal' on entity type 'OrderStateInstance'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2024-05-24 17:16:53.447 +00:00 [INF] Executed DbCommand (378ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [StateMachineDb];
2024-05-24 17:16:53.693 +00:00 [INF] Executed DbCommand (215ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [StateMachineDb] SET READ_COMMITTED_SNAPSHOT ON;
END;
2024-05-24 17:16:53.742 +00:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-24 17:16:53.850 +00:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2024-05-24 17:16:53.859 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-24 17:16:53.885 +00:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-24 17:16:53.911 +00:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-05-24 17:16:53.936 +00:00 [INF] Applying migration '20240517112515_InitialMigration'.
2024-05-24 17:16:54.022 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [InboxState] (
    [Id] bigint NOT NULL IDENTITY,
    [MessageId] uniqueidentifier NOT NULL,
    [ConsumerId] uniqueidentifier NOT NULL,
    [LockId] uniqueidentifier NOT NULL,
    [RowVersion] rowversion NULL,
    [Received] datetime2 NOT NULL,
    [ReceiveCount] int NOT NULL,
    [ExpirationTime] datetime2 NULL,
    [Consumed] datetime2 NULL,
    [Delivered] datetime2 NULL,
    [LastSequenceNumber] bigint NULL,
    CONSTRAINT [PK_InboxState] PRIMARY KEY ([Id]),
    CONSTRAINT [AK_InboxState_MessageId_ConsumerId] UNIQUE ([MessageId], [ConsumerId])
);
2024-05-24 17:16:54.052 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [OrderStateInstance] (
    [CorrelationId] uniqueidentifier NOT NULL,
    [CurrentState] nvarchar(max) NOT NULL,
    [OrderId] uniqueidentifier NOT NULL,
    [CustomerId] uniqueidentifier NOT NULL,
    [OrderTotal] decimal(18,2) NOT NULL,
    [CreatedDate] datetime2 NOT NULL,
    CONSTRAINT [PK_OrderStateInstance] PRIMARY KEY ([CorrelationId])
);
2024-05-24 17:16:54.062 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [OutboxMessage] (
    [SequenceNumber] bigint NOT NULL IDENTITY,
    [EnqueueTime] datetime2 NULL,
    [SentTime] datetime2 NOT NULL,
    [Headers] nvarchar(max) NULL,
    [Properties] nvarchar(max) NULL,
    [InboxMessageId] uniqueidentifier NULL,
    [InboxConsumerId] uniqueidentifier NULL,
    [OutboxId] uniqueidentifier NULL,
    [MessageId] uniqueidentifier NOT NULL,
    [ContentType] nvarchar(256) NOT NULL,
    [MessageType] nvarchar(max) NOT NULL,
    [Body] nvarchar(max) NOT NULL,
    [ConversationId] uniqueidentifier NULL,
    [CorrelationId] uniqueidentifier NULL,
    [InitiatorId] uniqueidentifier NULL,
    [RequestId] uniqueidentifier NULL,
    [SourceAddress] nvarchar(256) NULL,
    [DestinationAddress] nvarchar(256) NULL,
    [ResponseAddress] nvarchar(256) NULL,
    [FaultAddress] nvarchar(256) NULL,
    [ExpirationTime] datetime2 NULL,
    CONSTRAINT [PK_OutboxMessage] PRIMARY KEY ([SequenceNumber])
);
2024-05-24 17:16:54.071 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [OutboxState] (
    [OutboxId] uniqueidentifier NOT NULL,
    [LockId] uniqueidentifier NOT NULL,
    [RowVersion] rowversion NULL,
    [Created] datetime2 NOT NULL,
    [Delivered] datetime2 NULL,
    [LastSequenceNumber] bigint NULL,
    CONSTRAINT [PK_OutboxState] PRIMARY KEY ([OutboxId])
);
2024-05-24 17:16:54.080 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_InboxState_Delivered] ON [InboxState] ([Delivered]);
2024-05-24 17:16:54.108 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_OutboxMessage_EnqueueTime] ON [OutboxMessage] ([EnqueueTime]);
2024-05-24 17:16:54.116 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_OutboxMessage_ExpirationTime] ON [OutboxMessage] ([ExpirationTime]);
2024-05-24 17:16:54.166 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_OutboxMessage_InboxMessageId_InboxConsumerId_SequenceNumber] ON [OutboxMessage] ([InboxMessageId], [InboxConsumerId], [SequenceNumber]) WHERE [InboxMessageId] IS NOT NULL AND [InboxConsumerId] IS NOT NULL;
2024-05-24 17:16:54.193 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_OutboxMessage_OutboxId_SequenceNumber] ON [OutboxMessage] ([OutboxId], [SequenceNumber]) WHERE [OutboxId] IS NOT NULL;
2024-05-24 17:16:54.201 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_OutboxState_Created] ON [OutboxState] ([Created]);
2024-05-24 17:16:54.218 +00:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20240517112515_InitialMigration', N'8.0.4');
2024-05-24 17:16:54.854 +00:00 [INF] Configured endpoint create-order-message-queue, Saga: SagaOrchestration.StateInstances.OrderStateInstance, State Machine: SagaOrchestration.StateMachines.OrderStateMachine
2024-05-24 17:16:55.031 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-24 17:16:55.035 +00:00 [INF] Hosting environment: Development
2024-05-24 17:16:55.038 +00:00 [INF] Content root path: /app
2024-05-24 17:16:55.469 +00:00 [INF] Bus started: "rabbitmq://rabbitmq/"
2024-05-24 17:17:05.454 +00:00 [INF] Executed DbCommand (86ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:17:15.649 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:17:25.720 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:17:35.772 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:19:35.437 +00:00 [WRN] No store type was specified for the decimal property 'OrderTotal' on entity type 'OrderStateInstance'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2024-05-24 17:19:36.326 +00:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-24 17:19:36.361 +00:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-24 17:19:36.368 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-24 17:19:36.375 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-24 17:19:36.399 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-05-24 17:19:36.425 +00:00 [INF] No migrations were applied. The database is already up to date.
2024-05-24 17:19:36.810 +00:00 [INF] Configured endpoint create-order-message-queue, Saga: SagaOrchestration.StateInstances.OrderStateInstance, State Machine: SagaOrchestration.StateMachines.OrderStateMachine
2024-05-24 17:19:37.059 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-24 17:19:37.062 +00:00 [INF] Hosting environment: Development
2024-05-24 17:19:37.064 +00:00 [INF] Content root path: /app
2024-05-24 17:19:37.483 +00:00 [INF] Bus started: "rabbitmq://rabbitmq/"
2024-05-24 17:19:48.091 +00:00 [INF] Executed DbCommand (150ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:19:58.345 +00:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:20:08.370 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:20:18.425 +00:00 [INF] Executed DbCommand (26ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:20:28.450 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:20:38.496 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:20:48.513 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:20:58.584 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:21:08.636 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:21:18.647 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:21:28.681 +00:00 [INF] Executed DbCommand (25ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:21:38.703 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:23:35.576 +00:00 [WRN] No store type was specified for the decimal property 'OrderTotal' on entity type 'OrderStateInstance'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2024-05-24 17:23:37.708 +00:00 [INF] Executed DbCommand (104ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-24 17:23:37.829 +00:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-24 17:23:37.839 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-24 17:23:37.871 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-24 17:23:37.947 +00:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-05-24 17:23:37.997 +00:00 [INF] No migrations were applied. The database is already up to date.
2024-05-24 17:23:38.950 +00:00 [INF] Configured endpoint create-order-message-queue, Saga: SagaOrchestration.StateInstances.OrderStateInstance, State Machine: SagaOrchestration.StateMachines.OrderStateMachine
2024-05-24 17:23:39.291 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-24 17:23:39.297 +00:00 [INF] Hosting environment: Development
2024-05-24 17:23:39.321 +00:00 [INF] Content root path: /app
2024-05-24 17:23:39.641 +00:00 [INF] Bus started: "rabbitmq://rabbitmq/"
2024-05-24 17:23:50.559 +00:00 [INF] Executed DbCommand (100ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:24:00.787 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:24:10.847 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:24:20.862 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:24:30.869 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:24:40.878 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:24:50.886 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:25:00.940 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:25:11.008 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:25:21.038 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:25:31.067 +00:00 [INF] Executed DbCommand (24ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:25:41.074 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:25:51.122 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:26:01.137 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
2024-05-24 17:26:11.146 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__removeTimestamp_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [i].[Id], [i].[Consumed], [i].[ConsumerId], [i].[Delivered], [i].[ExpirationTime], [i].[LastSequenceNumber], [i].[LockId], [i].[MessageId], [i].[ReceiveCount], [i].[Received], [i].[RowVersion]
FROM [InboxState] AS [i]
WHERE [i].[Delivered] IS NOT NULL AND [i].[Delivered] < @__removeTimestamp_0
ORDER BY [i].[Delivered]
